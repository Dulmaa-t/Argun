{"ast":null,"code":"import _asyncToGenerator from\"/Users/maidar/Desktop/projects-d/gasp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/maidar/Desktop/projects-d/gasp/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/maidar/Desktop/projects-d/gasp/node_modules/@babel/runtime/regenerator/index.js\";import React,{useEffect,useState}from'react';import{toast}from'react-toastify';import axios from'utils/axios';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";export default function ConfigText(_ref){var configName=_ref.configName,_ref$title=_ref.title,title=_ref$title===void 0?\"\":_ref$title;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),value=_useState2[0],setValue=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),isEditing=_useState4[0],setEditing=_useState4[1];var handleChange=function handleChange(e){var changedValue=e.target.value;setValue(changedValue);};var getConfig=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$axios$get$catc,success,data,error,_data$;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(\"/api/config/?names=\".concat(configName)).catch(function(err){return err;});case 2:_yield$axios$get$catc=_context.sent;success=_yield$axios$get$catc.success;data=_yield$axios$get$catc.data;error=_yield$axios$get$catc.error;if(success){setValue((data===null||data===void 0?void 0:(_data$=data[0])===null||_data$===void 0?void 0:_data$.value)||\"\");}case 7:case\"end\":return _context.stop();}}},_callee);}));return function getConfig(){return _ref2.apply(this,arguments);};}();useEffect(function(){getConfig();},[]);var onSubmit=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var body,_yield$axios$put$catc,success,data,error,info;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:body={configs:{name:configName,value:value}};_context2.next=3;return axios.put(\"/api/config/\",body).catch(function(err){return err;});case 3:_yield$axios$put$catc=_context2.sent;success=_yield$axios$put$catc.success;data=_yield$axios$put$catc.data;error=_yield$axios$put$catc.error;info=_yield$axios$put$catc.info;if(success){toast.success(\"\".concat(title,\" \\u0437\\u0430\\u0441\\u043B\\u0430\\u0430\"));}else{toast.error(\"\".concat(title,\": \").concat(error));}case 9:case\"end\":return _context2.stop();}}},_callee2);}));return function onSubmit(){return _ref3.apply(this,arguments);};}();var handleClick=function handleClick(){var changed=!isEditing;if(!changed){onSubmit();}setEditing(changed);};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:configName,children:[title,\":\"]}),/*#__PURE__*/_jsx(\"textarea\",{type:\"text\",id:configName,readOnly:!isEditing,onChange:handleChange,value:value}),/*#__PURE__*/_jsx(\"button\",{onClick:handleClick,children:isEditing?\"save\":\"edit\"})]});}","map":{"version":3,"sources":["/Users/maidar/Desktop/projects-d/gasp/src/pages/Admin/Pages/Config/ConfigTextArea.js"],"names":["React","useEffect","useState","toast","axios","ConfigText","configName","title","value","setValue","isEditing","setEditing","handleChange","e","changedValue","target","getConfig","get","catch","err","success","data","error","onSubmit","body","configs","name","put","info","handleClick","changed"],"mappings":"oXAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CACA,OAASC,KAAT,KAAsB,gBAAtB,CAEA,MAAOC,CAAAA,KAAP,KAAkB,aAAlB,C,wFAEA,cAAe,SAASC,CAAAA,UAAT,MAA8C,IAAxBC,CAAAA,UAAwB,MAAxBA,UAAwB,iBAAZC,KAAY,CAAZA,KAAY,qBAAN,EAAM,YAEzD,cAA4BL,QAAQ,CAAC,EAAD,CAApC,wCAAQM,KAAR,eAAeC,QAAf,eACA,eAAkCP,QAAQ,EAA1C,yCAAQQ,SAAR,eAAmBC,UAAnB,eAEA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAACC,CAAD,CACrB,CACI,GAAMC,CAAAA,YAAY,CAAGD,CAAC,CAACE,MAAF,CAASP,KAA9B,CACAC,QAAQ,CAACK,YAAD,CAAR,CACH,CAJD,CAMA,GAAME,CAAAA,SAAS,2FAAG,6MAEyBZ,CAAAA,KAAK,CAACa,GAAN,8BAAgCX,UAAhC,GAA8CY,KAA9C,CAAoD,SAAAC,GAAG,QAAIA,CAAAA,GAAJ,EAAvD,CAFzB,4CAENC,OAFM,uBAENA,OAFM,CAEGC,IAFH,uBAEGA,IAFH,CAESC,KAFT,uBAESA,KAFT,CAGd,GAAIF,OAAJ,CACA,CACIX,QAAQ,CAAC,CAAAY,IAAI,OAAJ,EAAAA,IAAI,SAAJ,gBAAAA,IAAI,CAAG,CAAH,CAAJ,wCAAWb,KAAX,GAAoB,EAArB,CAAR,CACH,CANa,sDAAH,kBAATQ,CAAAA,SAAS,2CAAf,CASAf,SAAS,CACL,UACA,CACIe,SAAS,GACZ,CAJI,CAKL,EALK,CAAT,CAQA,GAAMO,CAAAA,QAAQ,2FAAG,+LAEPC,IAFO,CAEA,CACTC,OAAO,CAAE,CACLC,IAAI,CAAEpB,UADD,CAELE,KAAK,CAAEA,KAFF,CADA,CAFA,wBAQgCJ,CAAAA,KAAK,CAACuB,GAAN,gBAA0BH,IAA1B,EAAgCN,KAAhC,CAAsC,SAAAC,GAAG,QAAIA,CAAAA,GAAJ,EAAzC,CARhC,6CAQLC,OARK,uBAQLA,OARK,CAQIC,IARJ,uBAQIA,IARJ,CAQUC,KARV,uBAQUA,KARV,CAQiBM,IARjB,uBAQiBA,IARjB,CASb,GAAIR,OAAJ,CACA,CACIjB,KAAK,CAACiB,OAAN,WAAiBb,KAAjB,2CACH,CAHD,IAIK,CACDJ,KAAK,CAACmB,KAAN,WAAef,KAAf,cAAyBe,KAAzB,GACH,CAfY,wDAAH,kBAARC,CAAAA,QAAQ,2CAAd,CAkBA,GAAMM,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,EACpB,CACI,GAAMC,CAAAA,OAAO,CAAG,CAACpB,SAAjB,CACA,GAAI,CAACoB,OAAL,CACA,CACIP,QAAQ,GACX,CACDZ,UAAU,CAACmB,OAAD,CAAV,CACH,CARD,CAUA,mBACI,oCACI,eAAO,OAAO,CAAExB,UAAhB,WAA6BC,KAA7B,OADJ,cAEI,iBAAU,IAAI,CAAC,MAAf,CAAsB,EAAE,CAAED,UAA1B,CAAsC,QAAQ,CAAE,CAACI,SAAjD,CAA4D,QAAQ,CAAEE,YAAtE,CAAoF,KAAK,CAAEJ,KAA3F,EAFJ,cAGI,eAAQ,OAAO,CAAEqB,WAAjB,UAA+BnB,SAAS,CAAG,MAAH,CAAY,MAApD,EAHJ,GADJ,CAOH","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport { toast } from 'react-toastify'\n\nimport axios from 'utils/axios'\n\nexport default function ConfigText({ configName, title=\"\" }) {\n\n    const [ value, setValue ] = useState(\"\")\n    const [ isEditing, setEditing ] = useState()\n\n    const handleChange = (e) =>\n    {\n        const changedValue = e.target.value\n        setValue(changedValue)\n    }\n\n    const getConfig = async () =>\n    {\n        const { success, data, error } = await axios.get(`/api/config/?names=${configName}`).catch(err => err)\n        if (success)\n        {\n            setValue(data?.[0]?.value || \"\")\n        }\n    }\n\n    useEffect(\n        () =>\n        {\n            getConfig()\n        },\n        []\n    )\n\n    const onSubmit = async () =>\n    {\n        const body = {\n            configs: {\n                name: configName,\n                value: value\n            }\n        }\n        const { success, data, error, info } = await axios.put(`/api/config/`, body).catch(err => err)\n        if (success)\n        {\n            toast.success(`${title} заслаа`)\n        }\n        else {\n            toast.error(`${title}: ${error}`)\n        }\n    }\n\n    const handleClick = () =>\n    {\n        const changed = !isEditing\n        if (!changed)\n        {\n            onSubmit()\n        }\n        setEditing(changed)\n    }\n\n    return (\n        <div>\n            <label htmlFor={configName}>{title}:</label>\n            <textarea type=\"text\" id={configName} readOnly={!isEditing} onChange={handleChange} value={value}></textarea>\n            <button onClick={handleClick}>{isEditing ? \"save\" : \"edit\"}</button>\n        </div>\n    )\n}\n"]},"metadata":{},"sourceType":"module"}