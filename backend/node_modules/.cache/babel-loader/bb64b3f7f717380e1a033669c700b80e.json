{"ast":null,"code":"import _asyncToGenerator from\"/Users/maidar/Desktop/projects-d/gasp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/maidar/Desktop/projects-d/gasp/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/maidar/Desktop/projects-d/gasp/node_modules/@babel/runtime/regenerator/index.js\";import React,{useEffect,useState}from'react';import{Link}from'react-router-dom';import{toast}from'react-toastify';import Button from'../../../../components/main/Button';import axios from\"utils/axios\";import{timeZoneToDateString}from'../../../../utils';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function NewsList(){/** мэдээнүүдийг хадгалах state */var _useState=useState([]),_useState2=_slicedToArray(_useState,2),newsList=_useState2[0],setNews=_useState2[1];/** back аас мэдээний жагсаалтыг авах */var getNews=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$axios$get,success,data,error;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get('/api/news/');case 2:_yield$axios$get=_context.sent;success=_yield$axios$get.success;data=_yield$axios$get.data;error=_yield$axios$get.error;if(success){/** амжилттай дата авсан үед датаг state -д оноож өгөх нь */setNews(data);}else{/** алдаа гарвал alert харуулах */toast.error(error);}case 7:case\"end\":return _context.stop();}}},_callee);}));return function getNews(){return _ref.apply(this,arguments);};}();/** хуудас руу анх ороход мэдээний жагсаалтыг авах */useEffect(function(){getNews();},[]);/** Мэдээ устгах нь */var handleDelete=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(id){var _yield$axios$delete,success,data,info,error;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.delete(\"/api/news/\".concat(id,\"/\"));case 2:_yield$axios$delete=_context2.sent;success=_yield$axios$delete.success;data=_yield$axios$delete.data;info=_yield$axios$delete.info;error=_yield$axios$delete.error;if(success){/** амжилттай устгасны дараа alert харуулах нь */toast.success(info);getNews();}else{/** алдаа гарвал alert харуулах */toast.error(error);}case 8:case\"end\":return _context2.stop();}}},_callee2);}));return function handleDelete(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"page-title\",children:\"NEWS\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"page-content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"table-title\",children:/*#__PURE__*/_jsx(Link,{to:\"/admin/news/create/\",className:\"addBtn\",children:\"Add\"})}),/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"\\u0413\\u0430\\u0440\\u0447\\u0438\\u0433\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\u04AE\\u04AF\\u0441\\u0433\\u044D\\u0441\\u044D\\u043D\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\u041E\\u0433\\u043D\\u043E\\u043E\"}),/*#__PURE__*/_jsx(\"th\",{})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:newsList.map(function(news,idx){var _news$author;return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:news.title}),/*#__PURE__*/_jsx(\"td\",{children:((_news$author=news.author)===null||_news$author===void 0?void 0:_news$author.nickName)||\"\"}),/*#__PURE__*/_jsx(\"td\",{children:timeZoneToDateString(news.createdAt)}),/*#__PURE__*/_jsxs(\"td\",{children:[/*#__PURE__*/_jsx(Link,{to:\"/admin/news/update/\".concat(news._id,\"/\"),className:\"editBtn\",children:\"\\u0417\\u0430\\u0441\\u0430\\u0445\"}),/*#__PURE__*/_jsx(Button,{className:\"deleteBtn\",onClick:function onClick(){return handleDelete(news._id);},title:\"\\u0423\\u0441\\u0442\\u0433\\u0430\\u0445\"})]})]},idx);})})]})]})]});}","map":{"version":3,"sources":["/Users/maidar/Desktop/projects-d/gasp/src/pages/Admin/Pages/News/list.js"],"names":["React","useEffect","useState","Link","toast","Button","axios","timeZoneToDateString","NewsList","newsList","setNews","getNews","get","success","data","error","handleDelete","id","delete","info","map","news","idx","title","author","nickName","createdAt","_id"],"mappings":"oXAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CACA,OAASC,IAAT,KAAqB,kBAArB,CACA,OAASC,KAAT,KAAsB,gBAAtB,CAEA,MAAOC,CAAAA,MAAP,KAAmB,oCAAnB,CAEA,MAAOC,CAAAA,KAAP,KAAkB,aAAlB,CACA,OAASC,oBAAT,KAAqC,mBAArC,C,6IAEA,cAAe,SAASC,CAAAA,QAAT,EAAoB,CAE/B,kCACA,cAA4BN,QAAQ,CAAC,EAAD,CAApC,wCAAOO,QAAP,eAAiBC,OAAjB,eAEA,wCACA,GAAMC,CAAAA,OAAO,0FAAG,iMAC2BL,CAAAA,KAAK,CAACM,GAAN,CAAU,YAAV,CAD3B,uCACJC,OADI,kBACJA,OADI,CACKC,IADL,kBACKA,IADL,CACWC,KADX,kBACWA,KADX,CAEZ,GAAIF,OAAJ,CAAa,CACT,4DACAH,OAAO,CAACI,IAAD,CAAP,CACH,CAHD,IAIK,CACD,kCACAV,KAAK,CAACW,KAAN,CAAYA,KAAZ,EACH,CATW,sDAAH,kBAAPJ,CAAAA,OAAO,0CAAb,CAYA,qDACAV,SAAS,CAAC,UAAM,CACZU,OAAO,GACV,CAFQ,CAEN,EAFM,CAAT,CAIA,sBACA,GAAMK,CAAAA,YAAY,2FAAG,kBAAOC,EAAP,6LAC4BX,CAAAA,KAAK,CAACY,MAAN,qBAA0BD,EAA1B,MAD5B,2CACTJ,OADS,qBACTA,OADS,CACAC,IADA,qBACAA,IADA,CACMK,IADN,qBACMA,IADN,CACYJ,KADZ,qBACYA,KADZ,CAEjB,GAAIF,OAAJ,CAAa,CACT,iDACAT,KAAK,CAACS,OAAN,CAAcM,IAAd,EACAR,OAAO,GACV,CAJD,IAKK,CACD,kCACAP,KAAK,CAACW,KAAN,CAAYA,KAAZ,EACH,CAVgB,wDAAH,kBAAZC,CAAAA,YAAY,6CAAlB,CAaA,mBACI,wCACI,WAAI,SAAS,aAAb,kBADJ,cAGI,aAAK,SAAS,eAAd,wBACI,YAAK,SAAS,CAAC,aAAf,uBACI,KAAC,IAAD,EAAM,EAAE,CAAE,qBAAV,CAAiC,SAAS,CAAC,QAA3C,iBADJ,EADJ,cAII,sCACI,oCACI,mCACI,4DADJ,cAII,wEAJJ,cAOI,sDAPJ,cAUI,aAVJ,GADJ,EADJ,cAgBI,uBAEQP,QAAQ,CAACW,GAAT,CACI,SAACC,IAAD,CAAOC,GAAP,CAAe,kBACX,mBACI,mCACI,oBACKD,IAAI,CAACE,KADV,EADJ,cAII,oBACK,eAAAF,IAAI,CAACG,MAAL,oDAAaC,QAAb,GAAyB,EAD9B,EAJJ,cAOI,oBACKlB,oBAAoB,CAACc,IAAI,CAACK,SAAN,CADzB,EAPJ,cAUI,mCACI,KAAC,IAAD,EAAM,EAAE,8BAAwBL,IAAI,CAACM,GAA7B,KAAR,CAA6C,SAAS,CAAC,SAAvD,4CADJ,cAEI,KAAC,MAAD,EAAQ,SAAS,CAAC,WAAlB,CACI,OAAO,CAAE,yBAAMX,CAAAA,YAAY,CAACK,IAAI,CAACM,GAAN,CAAlB,EADb,CAEI,KAAK,CAAC,sCAFV,EAFJ,GAVJ,GAASL,GAAT,CADJ,CAoBH,CAtBL,CAFR,EAhBJ,GAJJ,GAHJ,GADJ,CAwDH","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport { Link } from 'react-router-dom'\nimport { toast } from 'react-toastify';\n\nimport Button from '../../../../components/main/Button';\n\nimport axios from \"utils/axios\"\nimport { timeZoneToDateString } from '../../../../utils'\n\nexport default function NewsList() {\n\n    /** мэдээнүүдийг хадгалах state */\n    const [newsList, setNews] = useState([])\n\n    /** back аас мэдээний жагсаалтыг авах */\n    const getNews = async () => {\n        const { success, data, error } = await axios.get('/api/news/')\n        if (success) {\n            /** амжилттай дата авсан үед датаг state -д оноож өгөх нь */\n            setNews(data)\n        }\n        else {\n            /** алдаа гарвал alert харуулах */\n            toast.error(error)\n        }\n    }\n\n    /** хуудас руу анх ороход мэдээний жагсаалтыг авах */\n    useEffect(() => {\n        getNews()\n    }, [])\n\n    /** Мэдээ устгах нь */\n    const handleDelete = async (id) => {\n        const { success, data, info, error } = await axios.delete(`/api/news/${id}/`)\n        if (success) {\n            /** амжилттай устгасны дараа alert харуулах нь */\n            toast.success(info)\n            getNews()\n        }\n        else {\n            /** алдаа гарвал alert харуулах */\n            toast.error(error)\n        }\n    }\n\n    return (\n        <>\n            <h1 className={`page-title`}>NEWS</h1>\n\n            <div className={`page-content`}>\n                <div className=\"table-title\">\n                    <Link to={\"/admin/news/create/\"} className=\"addBtn\">Add</Link>\n                </div>\n                <table>\n                    <thead>\n                        <tr>\n                            <th>\n                                Гарчиг\n                            </th>\n                            <th>\n                                Үүсгэсэн\n                            </th>\n                            <th>\n                                Огноо\n                            </th>\n                            <th>\n                            </th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        {\n                            newsList.map(\n                                (news, idx) => {\n                                    return (\n                                        <tr key={idx}>\n                                            <td>\n                                                {news.title}\n                                            </td>\n                                            <td>\n                                                {news.author?.nickName || \"\"}\n                                            </td>\n                                            <td>\n                                                {timeZoneToDateString(news.createdAt)}\n                                            </td>\n                                            <td>\n                                                <Link to={`/admin/news/update/${news._id}/`} className=\"editBtn\">Засах</Link>\n                                                <Button className=\"deleteBtn\"\n                                                    onClick={() => handleDelete(news._id)}\n                                                    title=\"Устгах\"\n                                                />\n                                            </td>\n                                        </tr>\n                                    )\n                                }\n                            )\n                        }\n                    </tbody>\n                </table>\n            </div>\n        </>\n    )\n}\n"]},"metadata":{},"sourceType":"module"}