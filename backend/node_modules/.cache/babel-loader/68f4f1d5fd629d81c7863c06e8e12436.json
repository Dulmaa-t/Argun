{"ast":null,"code":"import _toConsumableArray from\"/Users/maidar/Desktop/projects-d/gasp/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _asyncToGenerator from\"/Users/maidar/Desktop/projects-d/gasp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/maidar/Desktop/projects-d/gasp/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/maidar/Desktop/projects-d/gasp/node_modules/@babel/runtime/regenerator/index.js\";import React,{useEffect,useState}from'react';import{useLocation}from'react-router-dom';import HeaderMenu from'../../components/special/HeaderMenu';import Card from'../../components/main/newsCard';import Footer from'../Home/Footer';import MoreBtn from'../../components/special/MoreBtn';import axios from'utils/axios';import{timeZoneToDateString}from'utils/index';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function News(){/** news ийн мэдээллийг хадгалах state */var _useState=useState([]),_useState2=_slicedToArray(_useState,2),news=_useState2[0],setNews=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),start=_useState4[0],setStart=_useState4[1];var location=useLocation();/** news ийн мэдээллийг back аас дуудах нь */var getData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(newStart){var paramCatName;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:/** url ээс дарагдсан category байгаа эсэхийг анх орохдоо шалгах нь */paramCatName=new URLSearchParams(location.search).get(\"category\");_context.next=3;return axios.get(\"/api/news/\".concat(paramCatName?\"?category=\".concat(paramCatName,\"&start=\").concat(newStart):\"?start=\".concat(newStart))).then(function(_ref2){var success=_ref2.success,data=_ref2.data,error=_ref2.error;if(success){setNews([].concat(_toConsumableArray(news),_toConsumableArray(data)));}}).catch(function(err){});case 3:case\"end\":return _context.stop();}}},_callee);}));return function getData(_x){return _ref.apply(this,arguments);};}();useEffect(function(){//  news ийн мэдээллийг back аас дуудах нь\ngetData(start);},[]);var handleMore=function handleMore(){var newStart=news.length;getData(newStart);setStart(newStart);};/** Ямар category дарагдсан түүнийг авах функц */var handleCategory=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(catName){var _yield$axios$get,success,data,error;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setStart(0);_context2.next=3;return axios.get(\"/api/news/?category=\".concat(catName,\"&start=0\"));case 3:_yield$axios$get=_context2.sent;success=_yield$axios$get.success;data=_yield$axios$get.data;error=_yield$axios$get.error;if(success){setNews(data);}case 8:case\"end\":return _context2.stop();}}},_callee2);}));return function handleCategory(_x2){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(HeaderMenu,{handleCategory:handleCategory}),/*#__PURE__*/_jsx(\"div\",{className:\"news-menu\",children:/*#__PURE__*/_jsx(\"div\",{className:\"content-wrapper\",children:news.length>0?news.map(function(element,index){return/*#__PURE__*/_jsx(Card,{id:element._id,image:element.image,title:element.title,text:element.text,createdAt:timeZoneToDateString(element.createdAt)},index);}):\"Хоосон байна\"})}),news.length>0?/*#__PURE__*/_jsx(MoreBtn,{onClick:handleMore}):null,/*#__PURE__*/_jsx(Footer,{})]});}","map":{"version":3,"sources":["/Users/maidar/Desktop/projects-d/gasp/src/pages/News/main.jsx"],"names":["React","useEffect","useState","useLocation","HeaderMenu","Card","Footer","MoreBtn","axios","timeZoneToDateString","News","news","setNews","start","setStart","location","getData","newStart","paramCatName","URLSearchParams","search","get","then","success","data","error","catch","err","handleMore","length","handleCategory","catName","map","element","index","_id","image","title","text","createdAt"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport { useLocation } from 'react-router-dom'\n\nimport HeaderMenu from '../../components/special/HeaderMenu'\nimport Card from '../../components/main/newsCard'\nimport Footer from '../Home/Footer'\n\nimport MoreBtn from '../../components/special/MoreBtn'\n\nimport axios from 'utils/axios'\nimport { timeZoneToDateString } from 'utils/index'\n\nexport default function News() {\n\n  /** news ийн мэдээллийг хадгалах state */\n  const [ news, setNews ] = useState([])\n  const [ start, setStart ] = useState(0)\n  const location = useLocation()\n\n  /** news ийн мэдээллийг back аас дуудах нь */\n  const getData = async (newStart) =>\n  {\n    /** url ээс дарагдсан category байгаа эсэхийг анх орохдоо шалгах нь */\n    const paramCatName = new URLSearchParams(location.search).get(\"category\")\n    await axios.get(`/api/news/${paramCatName ? `?category=${paramCatName}&start=${newStart}` : `?start=${newStart}`}`)\n      .then(({ success, data, error }) =>\n        {\n          if (success)\n          {\n            setNews([ ...news, ...data ])\n          }\n        }\n      )\n      .catch(err =>\n        {\n\n        }\n      )\n  }\n\n  useEffect(\n    () =>\n    {\n      //  news ийн мэдээллийг back аас дуудах нь\n      getData(start)\n    },\n    []\n  )\n\n  const handleMore = () =>\n  {\n    const newStart = news.length\n    getData(newStart)\n    setStart(newStart)\n  }\n\n  /** Ямар category дарагдсан түүнийг авах функц */\n  const handleCategory = async (catName) =>\n  {\n    setStart(0)\n    const { success, data, error } = await axios.get(`/api/news/?category=${catName}&start=0`)\n    if (success)\n    {\n      setNews(data)\n    }\n  }\n\n  return (\n    <div>\n      <HeaderMenu handleCategory={handleCategory} />\n      <div className=\"news-menu\">\n        <div className=\"content-wrapper\">\n          {\n            news.length > 0\n            ?\n              news.map(\n                (element, index) => {\n                  return (\n                    <Card\n                      key={index}\n                      id={element._id}\n                      image={element.image}\n                      title={element.title}\n                      text={element.text}\n                      createdAt={timeZoneToDateString(element.createdAt)}\n                    />\n                  )\n                }\n              )\n            :\n              \"Хоосон байна\"\n          }\n        </div>\n      </div>\n      {\n        news.length > 0\n        ?\n          <MoreBtn onClick={handleMore}/>\n        :\n          null\n      }\n      <Footer />\n    </div>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}