{"ast":null,"code":"import _asyncToGenerator from\"/Users/maidar/Desktop/projects-d/gasp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/maidar/Desktop/projects-d/gasp/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/maidar/Desktop/projects-d/gasp/node_modules/@babel/runtime/regenerator/index.js\";import React,{createContext,useContext,useState}from'react';import{useNavigate}from'react-router-dom';import{toast}from'react-toastify';import axios from'utils/axios';import{jsx as _jsx}from\"react/jsx-runtime\";export var AuthContext=/*#__PURE__*/createContext();var initUserDetail={};export default function AuthContextProvider(props){/** хэрэглэгчийн мэдээлэл */var _useState=useState(initUserDetail),_useState2=_slicedToArray(_useState,2),userDetail=_useState2[0],setDetail=_useState2[1];var navigate=useNavigate();/** системд хэрэглэгчийн нэвтэрснээр бүртгэх */var loggedUser=function loggedUser(userData){//  хэрэглэгчийн мэдээллийг хадгалах нь\nsetDetail(userData);};/**\n     * Xэрэглэгчийн бүх мэдээллийг авах нь\n     * setDetail хийнэ\n     */var getDetail=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$axios$get$catc,success,data,error;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(\"/api/author/logged/\").catch(function(err){return err;});case 2:_yield$axios$get$catc=_context.sent;success=_yield$axios$get$catc.success;data=_yield$axios$get$catc.data;error=_yield$axios$get$catc.error;if(success){loggedUser(data?data:initUserDetail);}case 7:case\"end\":return _context.stop();}}},_callee);}));return function getDetail(){return _ref.apply(this,arguments);};}();/** Системээс гарах\n     * @param {boolean} hasToast гаргах эсэх\n    */var signOut=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var hasToast,_yield$axios$get$catc2,success,info,error,text,_text,_args2=arguments;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:hasToast=_args2.length>0&&_args2[0]!==undefined?_args2[0]:true;_context2.next=3;return axios.get(\"/api/sign/out/\").catch(function(err){return err;});case 3:_yield$axios$get$catc2=_context2.sent;success=_yield$axios$get$catc2.success;info=_yield$axios$get$catc2.info;error=_yield$axios$get$catc2.error;if(success){/** toast гаргах эсэх */if(hasToast){text=info;toast.success(text);}//  хэрэглэгчийн мэдээллийг хоослох нь\nsetDetail(initUserDetail);navigate(\"/admin/\");}else{if(hasToast){_text=error;toast.error(_text);}}case 8:case\"end\":return _context2.stop();}}},_callee2);}));return function signOut(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{getDetail:getDetail,signOut:signOut,setDetail:setDetail,loggedUser:loggedUser,userDetail:userDetail},children:props.children});}export function useAuth(){return useContext(AuthContext);}","map":{"version":3,"sources":["/Users/maidar/Desktop/projects-d/gasp/src/context/authContext.js"],"names":["React","createContext","useContext","useState","useNavigate","toast","axios","AuthContext","initUserDetail","AuthContextProvider","props","userDetail","setDetail","navigate","loggedUser","userData","getDetail","get","catch","err","success","data","error","signOut","hasToast","info","text","children","useAuth"],"mappings":"oXAAA,MAAOA,CAAAA,KAAP,EAAgBC,aAAhB,CAA+BC,UAA/B,CAA2CC,QAA3C,KAA2D,OAA3D,CACA,OAASC,WAAT,KAA4B,kBAA5B,CACA,OAASC,KAAT,KAAsB,gBAAtB,CAEA,MAAOC,CAAAA,KAAP,KAAkB,aAAlB,C,2CAEA,MAAO,IAAMC,CAAAA,WAAW,cAAGN,aAAa,EAAjC,CAEP,GAAMO,CAAAA,cAAc,CAAG,EAAvB,CACA,cAAe,SAASC,CAAAA,mBAAT,CAA6BC,KAA7B,CACf,CACI,4BACA,cAAkCP,QAAQ,CAACK,cAAD,CAA1C,wCAAQG,UAAR,eAAoBC,SAApB,eACA,GAAMC,CAAAA,QAAQ,CAAGT,WAAW,EAA5B,CAEA,+CACA,GAAMU,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,CAACC,QAAD,CAAc,CAC7B;AACAH,SAAS,CAACG,QAAD,CAAT,CACH,CAHD,CAKA;AACJ;AACA;AACA,OACI,GAAMC,CAAAA,SAAS,0FAAG,sMAEyBV,CAAAA,KAAK,CAACW,GAAN,CAAU,qBAAV,EAAiCC,KAAjC,CAAuC,SAAAC,GAAG,QAAIA,CAAAA,GAAJ,EAA1C,CAFzB,4CAENC,OAFM,uBAENA,OAFM,CAEGC,IAFH,uBAEGA,IAFH,CAESC,KAFT,uBAESA,KAFT,CAGd,GAAIF,OAAJ,CACA,CACIN,UAAU,CAACO,IAAI,CAAGA,IAAH,CAAUb,cAAf,CAAV,CACH,CANa,sDAAH,kBAATQ,CAAAA,SAAS,0CAAf,CASA;AACJ;AACA,MACI,GAAMO,CAAAA,OAAO,2FAAG,2NAAOC,QAAP,kDAAgB,IAAhB,wBAE2BlB,CAAAA,KAAK,CAACW,GAAN,CAAU,gBAAV,EAA4BC,KAA5B,CAAkC,SAAAC,GAAG,QAAIA,CAAAA,GAAJ,EAArC,CAF3B,8CAEJC,OAFI,wBAEJA,OAFI,CAEKK,IAFL,wBAEKA,IAFL,CAEWH,KAFX,wBAEWA,KAFX,CAGZ,GAAIF,OAAJ,CACA,CACI,wBACA,GAAII,QAAJ,CACA,CACUE,IADV,CACiBD,IADjB,CAEIpB,KAAK,CAACe,OAAN,CAAcM,IAAd,EACH,CACD;AACAd,SAAS,CAACJ,cAAD,CAAT,CACAK,QAAQ,CAAC,SAAD,CAAR,CACH,CAXD,IAYK,CACD,GAAIW,QAAJ,CACA,CACUE,KADV,CACiBJ,KADjB,CAEIjB,KAAK,CAACiB,KAAN,CAAYI,KAAZ,EACH,CACJ,CArBW,wDAAH,kBAAPH,CAAAA,OAAO,2CAAb,CAwBA,mBACI,KAAC,WAAD,CAAa,QAAb,EAAsB,KAAK,CAAE,CACzBP,SAAS,CAATA,SADyB,CAEzBO,OAAO,CAAPA,OAFyB,CAGzBX,SAAS,CAATA,SAHyB,CAIzBE,UAAU,CAAVA,UAJyB,CAKzBH,UAAU,CAAVA,UALyB,CAA7B,UAOKD,KAAK,CAACiB,QAPX,EADJ,CAWH,CAED,MAAO,SAASC,CAAAA,OAAT,EACP,CACI,MAAO1B,CAAAA,UAAU,CAACK,WAAD,CAAjB,CACH","sourcesContent":["import React, { createContext, useContext, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { toast } from 'react-toastify';\n\nimport axios from 'utils/axios'\n\nexport const AuthContext = createContext()\n\nconst initUserDetail = {}\nexport default function AuthContextProvider(props)\n{\n    /** хэрэглэгчийн мэдээлэл */\n    const [ userDetail, setDetail ] = useState(initUserDetail)\n    const navigate = useNavigate()\n\n    /** системд хэрэглэгчийн нэвтэрснээр бүртгэх */\n    const loggedUser = (userData) => {\n        //  хэрэглэгчийн мэдээллийг хадгалах нь\n        setDetail(userData)\n    }\n\n    /**\n     * Xэрэглэгчийн бүх мэдээллийг авах нь\n     * setDetail хийнэ\n     */\n    const getDetail = async () =>\n    {\n        const { success, data, error } = await axios.get(\"/api/author/logged/\").catch(err => err)\n        if (success)\n        {\n            loggedUser(data ? data : initUserDetail)\n        }\n    }\n\n    /** Системээс гарах\n     * @param {boolean} hasToast гаргах эсэх\n    */\n    const signOut = async (hasToast=true) =>\n    {\n        const { success, info, error } = await axios.get(\"/api/sign/out/\").catch(err => err)\n        if (success)\n        {\n            /** toast гаргах эсэх */\n            if (hasToast)\n            {\n                const text = info\n                toast.success(text)\n            }\n            //  хэрэглэгчийн мэдээллийг хоослох нь\n            setDetail(initUserDetail)\n            navigate(\"/admin/\")\n        }\n        else {\n            if (hasToast)\n            {\n                const text = error\n                toast.error(text)\n            }\n        }\n    }\n\n    return (\n        <AuthContext.Provider value={{\n            getDetail,\n            signOut,\n            setDetail,\n            loggedUser,\n            userDetail,\n        }}>\n            {props.children}\n        </AuthContext.Provider>\n    );\n}\n\nexport function useAuth()\n{\n    return useContext(AuthContext)\n}\n"]},"metadata":{},"sourceType":"module"}